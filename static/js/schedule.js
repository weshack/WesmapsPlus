// Generated by CoffeeScript 1.6.2
var Schedule,
  __indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };

window.theData = {
  'COMP112-02': {
    'Tuesday': [[9, 10.33]],
    'Thursday': [[9, 10.33]]
  },
  'COMP212-02': {
    'Monday': [[14.66, 16]],
    'Friday': [[14.66, 16]]
  }
};

Schedule = (function() {
  Schedule.earliest = 8;

  Schedule.latest = 22;

  Schedule.possColors = ['8c2318', '5e8c6a', '88a65e', 'bfb35a', 'f2c45a'];

  function Schedule(courseData, $wrapper) {
    var $newDay, d, _i, _len, _ref;

    this.courseData = courseData;
    this.$wrapper = $wrapper;
    this.days = {};
    this.colors = {};
    _ref = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
    for (_i = 0, _len = _ref.length; _i < _len; _i++) {
      d = _ref[_i];
      $newDay = $('<div class="day day-' + d + '"><div class="relative"></div></div>');
      this.$wrapper.append($newDay);
      $newDay.append('<div class="dayName">' + d.substring(0, 3) + '</div>');
      this.days[d] = $newDay.children('.relative');
    }
    this.draw();
  }

  Schedule.prototype.highlightCourse = function(course) {
    $('.mtg').addClass('fade');
    return $('.mtg-' + course).removeClass('fade');
  };

  Schedule.prototype.lowlightCourses = function() {
    return $('.mtg').removeClass('fade');
  };

  Schedule.prototype.draw = function() {
    var $el, $thisMtg, course, day, days, earliest, height, latest, t, thisColor, thisSchedule, times, top, _ref, _ref1, _results;

    _ref = this.days;
    for (day in _ref) {
      $el = _ref[day];
      $el.html('');
    }
    _ref1 = this.courseData;
    _results = [];
    for (course in _ref1) {
      days = _ref1[course];
      if (__indexOf.call(this.colors, course) >= 0) {
        thisColor = colors[course];
      } else {
        thisColor = Schedule.possColors.pop();
      }
      _results.push((function() {
        var _results1;

        _results1 = [];
        for (day in days) {
          times = days[day];
          _results1.push((function() {
            var _i, _len, _results2;

            _results2 = [];
            for (_i = 0, _len = times.length; _i < _len; _i++) {
              t = times[_i];
              earliest = Schedule.earliest;
              latest = Schedule.latest;
              top = (t[0] - earliest) * 100 / (latest - earliest);
              height = (t[1] - t[0]) * 100 / (latest - earliest);
              $thisMtg = $('<div class="mtg mtg-' + course + '"></div>');
              $thisMtg.css('top', top + '%').css('height', height + '%').css('background-color', '#' + thisColor).data('course', course);
              thisSchedule = this;
              $thisMtg.hover(function() {
                return thisSchedule.highlightCourse($(this).data('course'));
              }, function() {
                return thisSchedule.lowlightCourses();
              });
              _results2.push(this.days[day].append($thisMtg));
            }
            return _results2;
          }).call(this));
        }
        return _results1;
      }).call(this));
    }
    return _results;
  };

  return Schedule;

})();
