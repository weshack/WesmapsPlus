// Generated by CoffeeScript 1.3.3
var Schedule,
  __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
  __indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };

Schedule = (function() {

  Schedule.earliest = 8;

  Schedule.latest = 22;

  Schedule.possColors = ['8c2318', '5e8c6a', '88a65e', 'bfb35a', 'f2c45a'];

  function Schedule(courseData, $wrapper) {
    this.lowlightCourses = __bind(this.lowlightCourses, this);

    this.highlightCourse = __bind(this.highlightCourse, this);

    var $newDay, $rel, d, dayAbbrev, _i, _len, _ref;
    this.courseData = courseData;
    $rel = $('<div class="schedulerel"></div>');
    this.$wrapper = $wrapper;
    this.days = {};
    this.colors = {};
    this.$wrapper.append($rel);
    this.$wrapper = $rel;
    _ref = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
    for (_i = 0, _len = _ref.length; _i < _len; _i++) {
      d = _ref[_i];
      $newDay = $("<div class=day day-" + d + "'><div class='relative'></div></div>");
      this.$wrapper.append($newDay);
      dayAbbrev = d.substring(0, 3);
      $newDay.append("<div class='dayName'>" + dayAbbrev + "</div>");
      this.days[d] = $newDay.children('.relative');
    }
    this.draw();
  }

  Schedule.prototype.highlightCourse = function(course, x, y) {
    var title;
    title = allCourses[allSections[course]].title;
    $('.mtg').addClass('fade');
    $('.mtg-' + course).removeClass('fade');
    return notify(title);
  };

  Schedule.prototype.lowlightCourses = function() {
    $('.mtg').removeClass('fade');
    return notify("");
  };

  Schedule.prototype.draw = function() {
    var $el, $thisMtg, course, day, days, earliest, height, latest, t, thisColor, thisSchedule, times, top, _ref, _ref1, _results;
    _ref = this.days;
    for (day in _ref) {
      $el = _ref[day];
      $el.html('');
    }
    _ref1 = this.courseData;
    _results = [];
    for (course in _ref1) {
      days = _ref1[course];
      if (__indexOf.call(this.colors, course) >= 0) {
        thisColor = colors[course];
      } else {
        thisColor = Schedule.possColors.pop();
      }
      _results.push((function() {
        var _results1;
        _results1 = [];
        for (day in days) {
          times = days[day];
          _results1.push((function() {
            var _i, _len, _results2;
            _results2 = [];
            for (_i = 0, _len = times.length; _i < _len; _i++) {
              t = times[_i];
              earliest = Schedule.earliest;
              latest = Schedule.latest;
              top = (t[0] - earliest) * 100 / (latest - earliest);
              height = (t[1] - t[0]) * 100 / (latest - earliest);
              $thisMtg = $("<div class='mtg mtg-" + course + "'></div>");
              $thisMtg.css('top', top + '%').css('height', height + '%').css('background-color', '#' + thisColor).data('course', course);
              thisSchedule = this;
              $thisMtg.hover(function(evt) {
                return thisSchedule.highlightCourse($(this).data('course'), evt.pageX, evt.pageY);
              }, function() {
                return thisSchedule.lowlightCourses();
              });
              _results2.push(this.days[day].append($thisMtg));
            }
            return _results2;
          }).call(this));
        }
        return _results1;
      }).call(this));
    }
    return _results;
  };

  return Schedule;

})();
