// Generated by CoffeeScript 1.3.3
var autocomplete, courseTemplate, formatName, updateCourseResults;

courseTemplate = function(_arg) {
  var code, id, professor, title;
  id = _arg.id, code = _arg.code, title = _arg.title, professor = _arg.professor;
  return "<div class='course-result'>\n  <a href='/course?id=" + id + "'><p class='course-result-code'>" + code + "</p>\n  <p class='course-result-name'>" + title + "</p></a>\n  <p class='course-result-professor'>" + (formatName(professor)) + "</p>\n</div>";
};

formatName = function(name) {
  var first, last, _ref;
  if (name == null) {
    name = 'STAFF';
  }
  if (name === 'STAFF') {
    return name;
  }
  _ref = name.split(','), last = _ref[0], first = _ref[1];
  return "" + first + " " + last;
};

updateCourseResults = function(results) {
  var result, _i, _len, _results;
  $("#course-results").html('');
  _results = [];
  for (_i = 0, _len = results.length; _i < _len; _i++) {
    result = results[_i];
    _results.push($("#course-results").append(courseTemplate(result)));
  }
  return _results;
};

autocomplete = function(term, cb) {
  return $.getJSON('/search_by_title', {
    name: term
  }, function(results) {
    return cb(results);
  });
};

$(function() {
  return $("#course-search").on('keyup', function() {
    return autocomplete(this.value, function(courseResults) {
      return updateCourseResults(courseResults);
    });
  });
});
